---
title: "Bike rent business analysis"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
# cache results
knitr::opts_chunk$set(cache=TRUE, echo = TRUE, eval = TRUE, message=FALSE, warning = FALSE, fig.align='center')

```

We will explore sales and its association with different factors.

```{r library}
## Analysis
library(dplyr)
library(ggplot2)
library(modelr)
library(readr)
```




Here is the dataset:

```{r}
theme_set(theme_minimal())
day <- read_csv("day.csv")
select(day, instant:cnt)

```

I made a check for missing values and duplicates and deleting it.

```{r}
day <- read_csv("day.csv")
# 1. Deleting duplicates (if they are)
duplicates <- nrow(day[duplicated(day), ]) > 0
if (duplicates) {
  day <- day[!duplicated(day), ]
}
#2.Deleting missing values
missing_values <- any(is.na(day))
if (missing_values) {
  day <- na.omit(day)
}
```

I made data frames for each visualization into different data frames

```{r}
#Taking weather conditions
data_wethertocnt <- select(day, temp:windspeed, cnt)
select(day, temp:windspeed, cnt)

```

```{r}
#Taking avarage sales depending on the day of a week
average_sales_by_workingday <- day %>%
  group_by(workingday) %>%
  summarise(average_count = mean(cnt))

select(average_sales_by_workingday, workingday:average_count)
```
Now I made  plot for temperature association to sales quantity 

```{r}
ggplot(data_wethertocnt,
       aes(x = temp, y = cnt)) +
  geom_point() +
  ggtitle("Scatterplot of Temperature vs Total Count") +
  scale_color_brewer(palette = "Dark2")
```


Now I made association in which days sales will be bigger in working or on weekends


```{r}
ggplot(data = average_sales_by_workingday,
       aes(x = factor(workingday), y = average_count, fill = factor(workingday))) +
  geom_bar(stat = "identity") +
  ggtitle("Average Bike Rentals for Weekdays vs. Weekend Days") +
  xlab("Day Type (0 = Weekend, 1 = Weekday)") +
  ylab("Average Number of Bike Rentals") +
  scale_fill_manual(values = c("0" = "red", "1" = "blue"), labels = c("Weekend", "Weekday")) +
  scale_color_brewer(palette = "Dark2")
```

Association avarage sales to the season.

```{r}
#Grouping seasons and average sales into one data frame
average_sales_by_season <- day %>%
  group_by(season) %>%
  summarise(average_sales = mean(cnt))
select(average_sales_by_season, season:average_sales)
```

Renaming values in seasons names

```{r}
average_sales_by_season <- average_sales_by_season %>%
  mutate(season = case_when(
    season == 1 ~ "Winter",
    season == 2 ~ "Spring",
    season == 3 ~ "Summer",
    season == 4 ~ "Autumn"
  ))

```


Making a plot from this data

```{r}
#Transfering data in factor format to male our plot working correctly
average_sales_by_season$season <- as.factor(average_sales_by_season$season)

ggplot(average_sales_by_season, aes(x = season, y = average_sales)) +
  geom_col(fill = "lightblue") +
  theme_minimal() +
  labs(title = "Avarage sales by season",
       x = "Season",
       y = "Avarage sales")
```

